{"ast":null,"code":"import _regeneratorRuntime from\"/Users/zhubozhou/Documents/github/recipeee/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/zhubozhou/Documents/github/recipeee/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/zhubozhou/Documents/github/recipeee/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/zhubozhou/Documents/github/recipeee/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from'react';export var useFetch=function useFetch(url){var method=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'GET';var _useState=useState(null),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setisLoading=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),options=_useState8[0],setOptions=_useState8[1];var postData=function postData(_postData){setOptions({method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(_postData)// turn js object into a json string for posting\n});};useEffect(function(){var controller=new AbortController();var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(fetchOptions){var res,_data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setisLoading(true);_context.prev=1;_context.next=4;return fetch(url,_objectSpread(_objectSpread({},fetchOptions),{},{signal:controller.signal}));case 4:res=_context.sent;if(res.ok){_context.next=7;break;}throw new Error(res.statusText);case 7:_context.next=9;return res.json();case 9:_data=_context.sent;setisLoading(false);setData(_data);setError(null);_context.next=18;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](1);if(_context.t0.name==='AbortError'){console.log('the fetch was aborted');}else{setisLoading(false);setError('failed to fetch the data');}case 18:case\"end\":return _context.stop();}}},_callee,null,[[1,15]]);}));return function fetchData(_x){return _ref.apply(this,arguments);};}();if(method==='GET'){fetchData();}if(method==='POST'&&options){fetchData(options);}return function(){controller.abort();};},[url,method,options]);return{data:data,isLoading:isLoading,error:error,postData:postData};};","map":{"version":3,"names":["useState","useEffect","useFetch","url","method","data","setData","isLoading","setisLoading","error","setError","options","setOptions","postData","headers","body","JSON","stringify","controller","AbortController","fetchData","fetchOptions","fetch","signal","res","ok","Error","statusText","json","name","console","log","abort"],"sources":["/Users/zhubozhou/Documents/github/recipeee/src/hooks/useFetch.js"],"sourcesContent":["import { useState, useEffect } from 'react';\n\nexport const useFetch = (url, method = 'GET') => {\n    const [data, setData] = useState(null)\n    const [isLoading, setisLoading] = useState(false)\n    const [error, setError] = useState(null)\n    const [options, setOptions] = useState(null)\n\n    const postData = (postData) => {\n        setOptions({\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(postData) // turn js object into a json string for posting\n        })\n    }\n    useEffect(() => {\n        const controller = new AbortController()\n        const fetchData = async (fetchOptions) => {\n            setisLoading(true)\n            try {\n                const res = await fetch(url, { ...fetchOptions, signal: controller.signal })\n                if (!res.ok) {\n                    throw new Error(res.statusText)\n                }\n                const data = await res.json()\n                setisLoading(false)\n                setData(data)\n                setError(null)\n            }\n            catch (e) {\n                if (e.name === 'AbortError') {\n                    console.log('the fetch was aborted')\n                }\n                else {\n                    setisLoading(false)\n                    setError('failed to fetch the data')\n                }\n            }\n        }\n        if (method === 'GET') {\n            fetchData()\n        }\n        if (method === 'POST' && options) {\n            fetchData(options)\n        }\n        return () => { controller.abort() }\n    }, [url, method, options])\n\n    return { data, isLoading, error, postData }\n}\n"],"mappings":"goBAAA,OAASA,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,CAEA,MAAO,IAAMC,SAAQ,CAAG,QAAXA,SAAW,CAACC,GAAD,CAAyB,IAAnBC,OAAmB,2DAAV,KAAU,CAC7C,cAAwBJ,QAAQ,CAAC,IAAD,CAAhC,wCAAOK,IAAP,eAAaC,OAAb,eACA,eAAkCN,QAAQ,CAAC,KAAD,CAA1C,yCAAOO,SAAP,eAAkBC,YAAlB,eACA,eAA0BR,QAAQ,CAAC,IAAD,CAAlC,yCAAOS,KAAP,eAAcC,QAAd,eACA,eAA8BV,QAAQ,CAAC,IAAD,CAAtC,yCAAOW,OAAP,eAAgBC,UAAhB,eAEA,GAAMC,SAAQ,CAAG,kBAACA,SAAD,CAAc,CAC3BD,UAAU,CAAC,CACPR,MAAM,CAAE,MADD,CAEPU,OAAO,CAAE,CACL,eAAgB,kBADX,CAFF,CAKPC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeJ,SAAf,CAAyB;AALxB,CAAD,CAAV,CAOH,CARD,CASAZ,SAAS,CAAC,UAAM,CACZ,GAAMiB,WAAU,CAAG,GAAIC,gBAAJ,EAAnB,CACA,GAAMC,UAAS,0FAAG,iBAAOC,YAAP,gIACdb,YAAY,CAAC,IAAD,CAAZ,CADc,sCAGQc,MAAK,CAACnB,GAAD,gCAAWkB,YAAX,MAAyBE,MAAM,CAAEL,UAAU,CAACK,MAA5C,GAHb,QAGJC,GAHI,kBAILA,GAAG,CAACC,EAJC,8BAKA,IAAIC,MAAJ,CAAUF,GAAG,CAACG,UAAd,CALA,8BAOSH,IAAG,CAACI,IAAJ,EAPT,QAOJvB,KAPI,eAQVG,YAAY,CAAC,KAAD,CAAZ,CACAF,OAAO,CAACD,KAAD,CAAP,CACAK,QAAQ,CAAC,IAAD,CAAR,CAVU,iFAaV,GAAI,YAAEmB,IAAF,GAAW,YAAf,CAA6B,CACzBC,OAAO,CAACC,GAAR,CAAY,uBAAZ,EACH,CAFD,IAGK,CACDvB,YAAY,CAAC,KAAD,CAAZ,CACAE,QAAQ,CAAC,0BAAD,CAAR,CACH,CAnBS,qEAAH,kBAATU,UAAS,4CAAf,CAsBA,GAAIhB,MAAM,GAAK,KAAf,CAAsB,CAClBgB,SAAS,GACZ,CACD,GAAIhB,MAAM,GAAK,MAAX,EAAqBO,OAAzB,CAAkC,CAC9BS,SAAS,CAACT,OAAD,CAAT,CACH,CACD,MAAO,WAAM,CAAEO,UAAU,CAACc,KAAX,GAAoB,CAAnC,CACH,CA/BQ,CA+BN,CAAC7B,GAAD,CAAMC,MAAN,CAAcO,OAAd,CA/BM,CAAT,CAiCA,MAAO,CAAEN,IAAI,CAAJA,IAAF,CAAQE,SAAS,CAATA,SAAR,CAAmBE,KAAK,CAALA,KAAnB,CAA0BI,QAAQ,CAARA,QAA1B,CAAP,CACH,CAjDM"},"metadata":{},"sourceType":"module"}